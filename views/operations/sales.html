{% extends "views/layouts/base.html" %}
{% block title %}Operaciones{% endblock %}
{% block mycss %}{% endblock %}
{% block menutitle %}Reporte de ventas{% endblock %}
{% block content %}
<div class="row">
    <div class="col-12">
        <div class="row">
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title" style="color: #0095DA;">T-Maxima Regular</h5>
                            </div>
                            <div class="col-auto">
                                <div class="stat text-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-dollar-sign align-middle"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                                </div>
                            </div>
                        </div>
                        <h1 class="mt-1 mb-3">$ {{ today_sales[0].Monto | number_format(2, '.', ',') }}</h1>
                        <h5 class="mt-1 mb-3">Volumen: {{ today_sales[0].Volumen | number_format(2, '.', ',') ~ ' lts' }} | <b class="m-0 p-0" style="font-size: x-small;">El día de hoy: {{ now | date('Y-m-d')}}</b></h5>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title" style="color: #A6CE39;">T-Super Premium</h5>
                            </div>
                            <div class="col-auto">
                                <div class="stat text-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-dollar-sign align-middle"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                                </div>
                            </div>
                        </div>
                        <h1 class="mt-1 mb-3">$ {{ today_sales[1].Monto | number_format(2, '.', ',') }}</h1>
                        <h5 class="mt-1 mb-3">Volumen: {{ today_sales[1].Volumen | number_format(2, '.', ',') ~ ' lts' }} | <b class="m-0 p-0" style="font-size: x-small;">El día de hoy: {{ now | date('Y-m-d')}}</b></h5>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col mt-0">
                                <h5 class="card-title" style="color: #231E20;">Diesel Automotriz</h5>
                            </div>
                            <div class="col-auto">
                                <div class="stat text-primary">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-dollar-sign align-middle"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>
                                </div>
                            </div>
                        </div>
                        <h1 class="mt-1 mb-3">$ {{ today_sales[2].Monto | number_format(2, '.', ',') }}</h1>
                        <h5 class="mt-1 mb-3">Volumen: {{ today_sales[2].Volumen | number_format(2, '.', ',') ~ ' lts' }} | <b class="m-0 p-0" style="font-size: x-small;">El día de hoy: {{ now | date('Y-m-d')}}</b></h5>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header pb-0">
                <div class="card-actions float-end">
                    <div class="dropdown position-relative">
                        <a href="#" data-bs-toggle="dropdown" data-bs-display="static">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal align-middle">
                                <circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle>
                            </svg>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end">
                            <a class="dropdown-item" href="#" id="exportExcel"><i data-feather="file-text"></i> Exportar a Excel</a>
                            <a class="dropdown-item refresh_datatables_permissions" href="#"><i data-feather="refresh-ccw"></i> Actualizar</a>
                        </div>
                    </div>
                </div>
                <h5 class="card-title mb-0">Ventas por rango de fechas</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-12">
                        <form action="#" method="post">
                        <div class="row">
                                <div class="col">
                                    <label for="from" class="col-form-label col-form-label-sm">Fecha inicio: </label>
                                    <input type="date" class="form-control" name="from" id="from" value="{{ from_date }}">
                                </div>
                                <div class="col">
                                    <label for="until" class="col-form-label col-form-label-sm">Fecha final: </label>
                                    <input type="date" class="form-control" name="until" id="until" value="{{ until_date }}">
                                </div>
                                <div class="col-3 d-flex flex-column justify-content-between">
                                    <div></div>
                                    <button type="submit" class="btn btn-primary btn-block w-100" id="download_info"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg> Generar reporte</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        {% if from is defined %}
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title">Ventas</h5>
                            </div>
                            <table class="table table-striped table-sm table-responsive" style="font-size: x-small;" id="sales_table" data-from="{{ from }}" data-until="{{ until }}">
                                <thead>
                                    <tr>
                                        <th>FECHA</th>
                                        <th>PRODUCTO</th>
                                        <th>02 LERDO</th>
                                        <th>03 DELICIAS</th>
                                        <th>04 PARRAL</th>
                                        <th>05 LOPEZ MATEOS</th>
                                        <th>06 GEMELA CHICA</th>
                                        <th>07 GEM GRANDE</th>
                                        <th>08 PLUTARCO</th>
                                        <th>09 MPIO. LIBRE</th>
                                        <th>10 AZTECAS</th>
                                        <th>11 MISIONES</th>
                                        <th>12 PTO DE PALOS</th>
                                        <th>13 MIGUEL D MAD</th>
                                        <th>14 PERMUTA</th>
                                        <th>15 ELECTROLUX</th>
                                        <th>16 AERONAUTICA</th>
                                        <th>17 CUSTODIA</th>
                                        <th>18 ANAPRA</th>
                                        <th>19 INDEPENDENCI</th>
                                        <th>20 TECNOLOGICO</th>
                                        <th>21 EJERCITO NAL</th>
                                        <th>22 SATELITE</th>
                                        <th>23 LAS FUENTES</th>
                                        <th>24 CLARA</th>
                                        <th>25 SOLIS</th>
                                        <th>26 SANTIAGO TRO</th>
                                        <th>27 JARUDO</th>
                                        <th>28 HERMANOS ESC</th>
                                        <th>29 VILLA AHUMAD</th>
                                        <th>30 EL CASTAÑO</th>
                                        <th>31 TRAVEL CENTER</th>
                                        <th>32 PICACHOS</th>
                                        <th>33 VENTANAS</th>
                                        <th>34 SAN RAFAEL</th>
                                        <th>35 PUERTECITO</th>
                                        <th>36 JESUS MARIA</th>
                                        <th>TOTAL</th>
                                    </tr>
                                </thead>
                                <tbody>

                                </tbody>
                                <tfoot>
                                <tr>
                                    <th>FECHA</th>
                                    <th>PRODUCTO</th>
                                    <th>02 LERDO</th>
                                    <th>03 DELICIAS</th>
                                    <th>04 PARRAL</th>
                                    <th>05 LOPEZ MATEOS</th>
                                    <th>06 GEMELA CHICA</th>
                                    <th>07 GEM GRANDE</th>
                                    <th>08 PLUTARCO</th>
                                    <th>09 MPIO. LIBRE</th>
                                    <th>10 AZTECAS</th>
                                    <th>11 MISIONES</th>
                                    <th>12 PTO DE PALOS</th>
                                    <th>13 MIGUEL D MAD</th>
                                    <th>14 PERMUTA</th>
                                    <th>15 ELECTROLUX</th>
                                    <th>16 AERONAUTICA</th>
                                    <th>17 CUSTODIA</th>
                                    <th>18 ANAPRA</th>
                                    <th>19 INDEPENDENCI</th>
                                    <th>20 TECNOLOGICO</th>
                                    <th>21 EJERCITO NAL</th>
                                    <th>22 SATELITE</th>
                                    <th>23 LAS FUENTES</th>
                                    <th>24 CLARA</th>
                                    <th>25 SOLIS</th>
                                    <th>26 SANTIAGO TRO</th>
                                    <th>27 JARUDO</th>
                                    <th>28 HERMANOS ESC</th>
                                    <th>29 VILLA AHUMAD</th>
                                    <th>30 EL CASTAÑO</th>
                                    <th>31 TRAVEL CENTER</th>
                                    <th>32 PICACHOS</th>
                                    <th>33 VENTANAS</th>
                                    <th>34 SAN RAFAEL</th>
                                    <th>35 PUERTECITO</th>
                                    <th>36 JESUS MARIA</th>
                                    <th>TOTAL</th>
                                </tr>
                                </tfoot>
                            </table>
                        </div>
                        {% else %}
                        <div class="alert alert-warning alert-dismissible mt-2" role="alert">
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            <div class="alert-message">
                                <strong>¡Atención!</strong> Seleccione un rango de fechas para generar el reporte de ventas
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block myjs %}
<script src="{{ JS }}operations.js"></script>
{% endblock %}