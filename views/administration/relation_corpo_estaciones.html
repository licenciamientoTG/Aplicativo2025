{% extends "views/layouts/base.html" %}
{% block title %}Administracion{% endblock %}
{% block mycss %}
{% endblock %}
{% block menutitle %}Relacion Corporativo Estaciones {% endblock %}
{% block content %}

<style>
.estaciones-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin: 24px auto;
    max-width: 100vw;
    padding: 0 10px;
}
.estaciones-cards, 
#cards_facturas {
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* Solo 2 por fila */
    gap: 20px;
    padding: 0 10px;
    max-width: 100%;
    box-sizing: border-box;
}
@media (max-width: 768px) {
  .estaciones-cards,
  #cards_facturas {
    grid-template-columns: 1fr;
  }
}

.card-estacion {
    border: 1px solid #aaa;
    border-radius: 14px;
    box-shadow: 0 3px 6px #0001;
    padding: 12px 10px 10px 10px;
    min-width: 0;
    background: #fcfcfc;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.card-estacion h3 {
    margin-top: 0;
    margin-bottom: 6px;
    font-size: 1.1rem;
    font-weight: 600;
}

.resumen-fechas {
    margin-top: 6px;
    width: 100%;
}

.fecha-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 3px;
    font-size: 0.97rem;
}

.porciento-verde {
    color: #13af25;
    font-weight: bold;
}
.porciento-rojo {
    color: #d52c2c;
    font-weight: bold;
}
.actualizacion-info {
    font-style: italic;
    text-align: center;
    margin-bottom: 8px;
}
.div_btn_report {
    text-align: left;
    margin: 20px 0;
    display: flex;
    justify-content: space-between;
}
.btn_report {
    background-color: #007bff;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 15px;
    cursor: pointer;
}
.btn_report:hover {
    background-color: #0056b3;
}


#loader_estaciones .spinner {
  border: 5px solid #f3f3f3;
  border-top: 5px solid #333;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 0.7s linear infinite;
  margin: 0 auto;
}
@keyframes spin {
  100% { transform: rotate(360deg); }
}
.resumen-5columnas {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 4px;
    font-size: 0.92rem;
    padding: 0;
    margin: 0;
}

.resumen-5columnas.encabezado {
    font-weight: bold;
    color: #444;
    border-bottom: 1px solid #ccc;
    padding-bottom: 4px;
    margin-bottom: 6px;
}
</style>

<ul class="nav nav-tabs" id="myTab" role="tablist">

    <li class="nav-item" role="presentation">
        <button class="nav-link active " id="despachos_relation-tab" data-bs-toggle="tab" data-bs-target="#despachos_relation" type="button" role="tab" aria-controls="despachos_relation" aria-selected="true">Despachos</button>
    </li>
   
     <li class="nav-item" role="presentation">
        <button class="nav-link " id="despachos_facturados-tab" data-bs-toggle="tab" data-bs-target="#despachos_facturados" type="button" role="tab" aria-controls="despachos_facturados" aria-selected="true">Despachos Facturados</button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link " id="facturas-tab" data-bs-toggle="tab" data-bs-target="#facturas" type="button" role="tab" aria-controls="facturas" aria-selected="true">Facturas</button>
    </li>
</ul>


<div class="tab-content" >
    <div class="tab-pane active" id="despachos_relation" role="tabpanel" aria-labelledby="despachos_relation-tab">

        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-2 ">
                        <label class="col-form-label-sm" for="from_desp">Desde: </label>
                        <input type="date"  class="form-control form-control-sm" name="from_desp" id="from_desp"  value="{{ ('now'|date_modify('-3 days'))|date('Y-m-d')}}" required>
                    </div>
                    <div class="col-2 ">
                        <label class="col-form-label-sm" for="until_desp">Hasta: </label>
                        <input type="date" class="form-control form-control-sm" name="until_desp" id="until_desp" value="{{ (until != false) ? until : 'now'|date('Y-m-d') }}"  required>
                    </div>
                    <div class="col-2 ">
                        <label class="col-form-label-sm" for="estacion_desp">Estacion </label>
                        <select class="form-control form-control-sm" name="estacion_desp" id="estacion_desp" required>
                            <option value="0">Todas</option>
                            {% for estation in estations %}
                            <option value="{{ estation.codigo }}">{{ estation.estacion_nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-2 " >
                        <button onclick="porcent_estacion_info()" class="btn btn-sm btn-primary" style="width: 100%; margin-top: 15px;">Generar Reporte</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="div_btn_report" id="div_despachos_relation">
            <h3>Despachos</h3>
            <!-- <button class="btn_report" onclick="porcent_estacion_info()">Reporte</button> -->
        </div>

        <div class="actualizacion-info" id="fecha_actualizacion"></div>
        <div class="estaciones-cards" id="cards_estaciones"></div>

    </div>
    <div class="tab-pane " id="despachos_facturados" role="tabpanel" aria-labelledby="despachos_facturados-tab">
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-2 ">
                        <label class="col-form-label-sm" for="from_desp2">Desde: </label>
                        <input type="date"  class="form-control form-control-sm" name="from_desp2" id="from_desp2"  value="{{ ('now'|date_modify('-3 days'))|date('Y-m-d') }}" required>
                    </div>
                    <div class="col-2 ">
                        <label class="col-form-label-sm" for="until_desp2">Hasta: </label>
                        <input type="date" class="form-control form-control-sm" name="until_desp2" id="until_desp2" value="{{ (until != false) ? until : 'now'|date('Y-m-d') }}"  required>
                    </div>
                    <div class="col-2 ">
                        <label class="col-form-label-sm" for="estacion_desp2">Estacion </label>
                        <select class="form-control form-control-sm" name="estacion_desp2" id="estacion_desp2" required>
                            <option value="0">Todas</option>
                            {% for estation in estations %}
                            <option value="{{ estation.codigo }}">{{ estation.estacion_nombre }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-2 " >
                        <button onclick="porcent_estacion_facturados_info()" class="btn btn-sm btn-primary" style="width: 100%; margin-top: 15px;">Generar Reporte</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="div_btn_report" id="div_despachos_facturados">
            <h3>Despachos Facturados</h3>
        </div>


        <div class="actualizacion-info" id="fecha_actualizacion_facturados"></div>
        <div class="estaciones-cards" id="cards_estaciones_facturados"></div>

    </div>

    <div class="tab-pane " id="facturas" role="tabpanel" aria-labelledby="facturas-tab">
        <div style="display: flex;flex-direction: row;flex-wrap: wrap; justify-content: space-around">

            <div class="card col-7" style="margin: 0 10px;">
                <div class="card-body">
                    <div class="row">
                        <div class="col-2 ">
                            <label class="col-form-label-sm" for="from_desp3">Desde: </label>
                            <input type="date"  class="form-control form-control-sm" name="from_desp3" id="from_desp3"  value="{{ ('now'|date_modify('-3 days'))|date('Y-m-d') }}" required>
                        </div>
                        <div class="col-2 ">
                            <label class="col-form-label-sm" for="until_desp3">Hasta: </label>
                            <input type="date" class="form-control form-control-sm" name="until_desp3" id="until_desp3" value="{{ (until != false) ? until : 'now'|date('Y-m-d') }}"  required>
                        </div>
                        <div class="col-2 ">
                            <label class="col-form-label-sm" for="estacion_desp3">Estacion </label>
                            <select class="form-control form-control-sm" name="estacion_desp3" id="estacion_desp3" required>
                                <option value="0">Todas</option>
                                {% for estation in estations %}
                                <option value="{{ estation.codigo }}">{{ estation.estacion_nombre }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-2 " >
                            <button onclick="porcent_facturas_info()" class="btn btn-sm btn-primary" style="width: 100%; margin-top: 15px;">Generar Reporte</button>
                        </div>
                    </div>
                    
                    
                </div>
            </div>
            <div class="card col-4 " style="margin: 0 10px;">
                <div class="card-body">
                    <div style="font-family: Arial, sans-serif; font-size: 0.9em; line-height: 1.6;">
                    <ul style="padding-left: 16px; margin: 0;">
                        <li><strong>W</strong>: Notas de crédito</li>
                        <li><strong>C</strong>: Contado</li>
                        <li><strong>CC</strong>: Compra Combustible</li>
                        <li><strong>CA</strong>: Compra Aceites</li>
                        <li><strong>CO</strong>: Cobros</li>
                        <li><strong>D</strong>: Anticipos</li>
                        <li><strong>E</strong>: Consignaciones</li>
                        <li><strong>I</strong>: Crédito</li>
                        <li><strong>K</strong>: Web</li>
                        <li><strong>T</strong>: Terminales</li>
                        <li><strong>Y-F</strong>: Facturación Arrendamiento</li>
                        <li><strong>Y-FA</strong>: Facturación Administrativa</li>
                        <li><strong>Z</strong>: Global</li>
                    </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="div_btn_report">
            <h3>Facturas</h3>
        </div>

        <div class="actualizacion-info" id="fecha_actualizacion_facturas"></div>
        <div class="estaciones-cards" id="cards_facturas"></div>

    </div>
</div>



{% endblock %}
{% block myjs %}
<!-- <script src="{{ JS }}accounting.js"></script> -->
<script>

    // print_station_info();

</script>


{% endblock %}